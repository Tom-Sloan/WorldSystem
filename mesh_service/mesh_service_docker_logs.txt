
==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 0, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-BDaAyVAw9psV11GbYoATSw
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Received signal 15, shutting down...
Shutting down...

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 0, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-fXMqsyXK7UBDODR8yC7ftQ
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Received signal 15, shutting down...
Shutting down...

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 0, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-E5Rt88sLmSmD-e-Gr9kIRg
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Received signal 15, shutting down...
Shutting down...

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 0, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-_PnCsNxthB3sqTJXZxOFRw
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x71bf7063c000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Normal estimation completed in 11361ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599883
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=6.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=11.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=5.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=5.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 117729, weight=5.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 117730, weight=2.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=9.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=8.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 109650, weight=5.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=7.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109648): coords=[48,70,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109649): coords=[49,70,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109650): coords=[50,70,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.050,-0.035,-0.097,-0.097,0.006,-0.011,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.059,-0.031,1.000,1.000,-0.026,-0.008,0.015,-0.058]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.031,0.091,1.000,1.000,-0.008,0.045,0.099,0.015]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.091,1.000,1.000,1.000,0.045,1.000,1.000,0.099]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.079,-0.004,-0.031,-0.059,0.047,0.015,-0.008,-0.026]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=223, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=179, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=17, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=207, num_verts=6
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5922
  Total vertices to generate: 38058
  Last vert scan: 38055, orig: 3
  Last occupied scan: 5921, orig: 1
[MC DEBUG] Generating triangles for 5922 active voxels with 38058 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 70, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-0CBitNm5BJJPUkEj5FdQTg
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x70540811c000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11751ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599886
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=3.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109248, weight=12.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 109249, weight=14.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109250, weight=8.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 108207, weight=6.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 108208, weight=10.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 108209, weight=10.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 108210, weight=8.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=9.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117247, weight=6.000, pos=4
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 109248): coords=[48,65,13]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109249): coords=[49,65,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109250): coords=[50,65,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117247): coords=[47,65,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.092,-0.038,-0.075,-0.083,-0.032,0.003,-0.070,-0.080]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.038,-0.002,-0.025,-0.075,0.003,0.045,-0.026,-0.070]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.002,1.000,1.000,-0.025,0.045,1.000,1.000,-0.026]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.099,-0.047,-0.011,-0.097,-0.098,-0.007,-0.045,-0.098]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.099,-0.032,-0.080,-0.098,-0.098,-0.023,-0.014,-0.099]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=223, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=207, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=137, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5992
  Total vertices to generate: 39045
  Last vert scan: 39045, orig: 0
  Last occupied scan: 5992, orig: 0
[MC DEBUG] Generating triangles for 5992 active voxels with 39045 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 139, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-wgepDfFRXQbqYoWWvzoWlQ
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x78f4fc01c000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11970ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599888
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=6.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=7.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=4.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 123968, weight=12.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 123969, weight=13.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 123970, weight=10.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=8.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=8.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 109650, weight=4.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 124127, weight=8.000, pos=3
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109570): coords=[50,69,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 124127): coords=[47,51,15]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109648): coords=[48,70,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.096,-0.021,-0.003,-0.054,-0.064,0.017,0.012,-0.034]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.021,0.019,0.075,-0.003,0.017,0.019,0.050,0.012]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [0.019,1.000,1.000,0.075,0.019,1.000,1.000,0.050]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.096,-0.060,-0.063,-0.097,-0.099,-0.037,-0.060,-0.099]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.054,-0.003,1.000,1.000,-0.034,0.012,0.026,-0.033]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=159, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=9, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=147, num_verts=12
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5995
  Total vertices to generate: 39027
  Last vert scan: 39027, orig: 0
  Last occupied scan: 5995, orig: 0
[MC DEBUG] Generating triangles for 5995 active voxels with 39027 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 210, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-5hDtpp6_g_oJ1UaK1Lpd0g
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 38
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7e9bf85c8000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11537ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599884
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101408, weight=4.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 101409, weight=4.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 101410, weight=3.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=8.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=7.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=3.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=4.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=5.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=3.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=6.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 101568): coords=[48,69,12]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 101569): coords=[49,69,12]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 101570): coords=[50,69,12]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 101408): coords=[48,67,12]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.097,-0.030,-0.043,-0.097,-0.098,-0.021,-0.015,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.094,-0.083,-0.097,1.000,-0.095,-0.006,0.009,-0.048]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.083,-0.096,1.000,-0.097,-0.006,0.066,0.035,0.009]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.096,1.000,1.000,1.000,0.066,1.000,1.000,0.035]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.093,-0.080,-0.093,-0.096,-0.074,-0.037,-0.005,-0.077]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=183, num_verts=12
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=27, num_verts=12
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=1, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5953
  Total vertices to generate: 38826
  Last vert scan: 38820, orig: 6
  Last occupied scan: 5952, orig: 1
[MC DEBUG] Generating triangles for 5953 active voxels with 38826 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 277, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-5P-ego2nVOMGPAVfSxed1A
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x73e9c0240000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11713ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599884
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117408, weight=8.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117409, weight=18.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117410, weight=8.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 101488, weight=7.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 101489, weight=5.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 101008, weight=5.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 101009, weight=7.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 101010, weight=3.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 116927, weight=3.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 117247, weight=5.000, pos=7
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 101008): coords=[48,62,12]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 101009): coords=[49,62,12]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 101010): coords=[50,62,12]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117408): coords=[48,67,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117409): coords=[49,67,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.094,-0.081,-0.091,-0.094,-0.092,-0.061,-0.079]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.094,-0.098,-0.095,-0.081,-0.092,-0.062,-0.041,-0.061]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.098,1.000,1.000,-0.095,-0.062,1.000,1.000,-0.041]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.018,-0.030,0.038,-0.030,0.006,-0.001,0.016,-0.042]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.030,0.022,0.065,0.038,-0.001,0.046,0.027,0.016]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=153, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=171, num_verts=15
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=17, num_verts=6
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6041
  Total vertices to generate: 39288
  Last vert scan: 39288, orig: 0
  Last occupied scan: 6041, orig: 0
[MC DEBUG] Generating triangles for 6041 active voxels with 39288 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 350, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-UKBbX9BSAQsXOikL0GwYWg
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x74a9a0148000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11817ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599886
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109248, weight=14.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109249, weight=14.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109250, weight=10.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=7.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 108528, weight=8.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 108529, weight=11.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 108530, weight=10.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 116927, weight=3.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 108447, weight=6.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 108287, weight=7.000, pos=5
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 108447): coords=[47,55,13]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 108528): coords=[48,56,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 108529): coords=[49,56,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 108530): coords=[50,56,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 116927): coords=[47,61,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.099,-0.094,-0.096,1.000,-0.096,-0.077,-0.090,-0.100]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.096,-0.090,-0.076,-0.084,-0.090,-0.025,-0.067,-0.083]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.090,-0.097,-0.065,-0.076,-0.025,-0.014,-0.048,-0.067]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.097,1.000,1.000,-0.065,-0.014,0.100,1.000,-0.048]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.100,-0.081,-0.085,-0.099,-0.100,-0.050,-0.062,-0.099]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=247, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=153, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5974
  Total vertices to generate: 38808
  Last vert scan: 38808, orig: 0
  Last occupied scan: 5974, orig: 0
[MC DEBUG] Generating triangles for 5974 active voxels with 38808 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 419, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-FveUvnw081uFwgqplh5BCA
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x76097c120000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11406ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599888
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=4.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=4.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=3.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=7.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=7.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=5.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 124047, weight=10.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 101488, weight=6.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 101489, weight=8.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 101490, weight=5.000, pos=8
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 101568): coords=[48,69,12]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 101569): coords=[49,69,12]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 101570): coords=[50,69,12]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.094,-0.093,-0.098,1.000,-0.082,0.018,0.006,-0.074]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.093,-0.098,1.000,-0.098,0.018,0.044,0.059,0.006]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.098,1.000,1.000,1.000,0.044,1.000,1.000,0.059]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.082,0.018,0.006,-0.074,0.026,0.027,0.007,-0.007]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [0.018,0.044,0.059,0.006,0.027,0.044,0.042,0.007]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=151, num_verts=15
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=11, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=1, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=137, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=0, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6020
  Total vertices to generate: 39570
  Last vert scan: 39570, orig: 0
  Last occupied scan: 6020, orig: 0
[MC DEBUG] Generating triangles for 6020 active voxels with 39570 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 486, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-NStoDoOmpl3kaxGJCsu1mA
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7e49545c5000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11597ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599883
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=5.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=5.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=2.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=8.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=10.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=4.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 108528, weight=7.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 108529, weight=12.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 108530, weight=6.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=6.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109570): coords=[50,69,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 101568): coords=[48,69,12]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.097,-0.014,-0.028,-0.098,-0.098,-0.015,-0.037,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.097,-0.019,-0.011,-0.049,0.001,0.004,-0.020,-0.045]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.019,0.042,0.023,-0.011,0.004,0.024,0.058,-0.020]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.042,1.000,1.000,0.023,0.024,1.000,1.000,0.058]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.094,-0.095,-0.098,1.000,-0.097,-0.019,-0.011,-0.049]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=207, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=137, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=247, num_verts=3
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5945
  Total vertices to generate: 38673
  Last vert scan: 38673, orig: 0
  Last occupied scan: 5945, orig: 0
[MC DEBUG] Generating triangles for 5945 active voxels with 38673 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 555, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-nAMRV_uQjvJwbv20yhaptw
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7de54c784000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11741ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599886
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101408, weight=4.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=3.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=4.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=3.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 124288, weight=12.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 124289, weight=14.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 124290, weight=11.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=5.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=7.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=2.000, pos=5
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 101568): coords=[48,69,12]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 101569): coords=[49,69,12]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 101570): coords=[50,69,12]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.092,-0.090,-0.097,1.000,-0.097,0.016,0.000,-0.068]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.090,-0.097,1.000,-0.097,0.016,-0.017,0.063,0.000]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.097,1.000,1.000,1.000,-0.017,1.000,1.000,0.063]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.097,0.016,0.000,-0.068,0.013,-0.004,-0.016,-0.039]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [0.016,-0.017,0.063,0.000,-0.004,0.060,0.021,-0.016]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=151, num_verts=15
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=43, num_verts=12
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=17, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=233, num_verts=15
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=146, num_verts=9
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5929
  Total vertices to generate: 38943
  Last vert scan: 38934, orig: 9
  Last occupied scan: 5928, orig: 1
[MC DEBUG] Generating triangles for 5929 active voxels with 38943 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 626, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-IuPtwXheeqNxPjQgSjXDdQ
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7fec904c3000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11825ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599884
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=3.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=4.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=1.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=7.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=7.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=6.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 101649, weight=4.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=8.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=9.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109650, weight=9.000, pos=8
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109570): coords=[50,69,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 101568): coords=[48,69,12]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 101569): coords=[49,69,12]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.089,-0.038,-0.027,-0.050,0.005,0.007,-0.006,-0.030]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.038,0.214,0.005,-0.027,0.007,0.055,0.182,-0.006]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [0.214,1.000,1.000,0.005,0.055,1.000,1.000,0.182]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.096,-0.094,-0.097,1.000,-0.089,-0.038,-0.027,-0.050]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.094,-0.100,1.000,-0.097,-0.038,0.214,0.005,-0.027]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=207, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=137, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=247, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=155, num_verts=9
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5981
  Total vertices to generate: 39000
  Last vert scan: 39000, orig: 0
  Last occupied scan: 5981, orig: 0
[MC DEBUG] Generating triangles for 5981 active voxels with 39000 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 695, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-ThPZFi43qx6bx2pavC816Q
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x77abfc522000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11549ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599883
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=7.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=9.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=4.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117248, weight=12.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117249, weight=12.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 117250, weight=19.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 108688, weight=7.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 108689, weight=8.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 108690, weight=6.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=8.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109570): coords=[50,69,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117248): coords=[48,65,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.076,-0.043,-0.097,-0.098,-0.043,-0.032,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.096,0.001,-0.006,-0.045,0.002,-0.003,-0.024,-0.040]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [0.001,0.050,0.063,-0.006,-0.003,0.005,0.022,-0.024]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.050,1.000,1.000,0.063,0.005,1.000,1.000,0.022]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.028,0.014,-0.066,-0.073,-0.016,-0.051,-0.053,-0.038]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=237, num_verts=12
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=152, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=253, num_verts=3
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5999
  Total vertices to generate: 39171
  Last vert scan: 39171, orig: 0
  Last occupied scan: 5999, orig: 0
[MC DEBUG] Generating triangles for 5999 active voxels with 39171 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 766, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-mfuPRE9iI5MwEQ9_eQ1H-A
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x742810283000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11493ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599889
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 116928, weight=9.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 116768, weight=13.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 116769, weight=13.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 116770, weight=10.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=9.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=7.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 109650, weight=7.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117247, weight=7.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 116927, weight=3.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=5.000, pos=8
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 116927): coords=[47,61,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109648): coords=[48,70,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109649): coords=[49,70,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 109650): coords=[50,70,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 116768): coords=[48,59,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.100,-0.076,-0.085,-0.099,-0.099,-0.049,-0.070,-0.099]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.068,0.012,1.000,1.000,0.023,0.017,0.015,-0.049]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [0.012,0.324,1.000,1.000,0.017,0.037,0.099,0.015]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.324,1.000,1.000,1.000,0.037,1.000,1.000,0.099]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.080,-0.047,-0.075,-0.096,-0.042,-0.022,-0.029,-0.031]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=129, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6043
  Total vertices to generate: 39039
  Last vert scan: 39039, orig: 0
  Last occupied scan: 6043, orig: 0
[MC DEBUG] Generating triangles for 6043 active voxels with 39039 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 833, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-9mZJmmCUYIyBlAIAGwmg3w
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7dfe68062000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11551ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599886
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=4.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117729, weight=5.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 117730, weight=2.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 108688, weight=10.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 108689, weight=9.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 108690, weight=8.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=10.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=11.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 109650, weight=8.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=4.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 108688): coords=[48,58,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 108689): coords=[49,58,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 108690): coords=[50,58,13]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117728): coords=[48,71,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.058,-0.043,-0.097,-0.097,-0.038,0.010,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.091,-0.091,-0.085,-0.091,-0.089,-0.070,-0.008,-0.083]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.091,-0.091,-0.067,-0.085,-0.070,-0.045,0.038,-0.008]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.091,1.000,1.000,-0.067,-0.045,1.000,1.000,0.038]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.049,0.015,1.000,1.000,-0.023,-0.001,-0.002,-0.097]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=191, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=191, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=25, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=241, num_verts=9
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6035
  Total vertices to generate: 39300
  Last vert scan: 39294, orig: 6
  Last occupied scan: 6034, orig: 1
[MC DEBUG] Generating triangles for 6035 active voxels with 39300 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 903, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-gQkfygpCGB6CXgR4pWMsVQ
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x749db801c000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11574ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599888
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=6.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=5.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=2.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 117408, weight=15.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 117409, weight=9.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 117410, weight=8.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 108688, weight=10.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 108689, weight=12.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 108690, weight=8.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=6.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 117408): coords=[48,67,14]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 117409): coords=[49,67,14]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117410): coords=[50,67,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.099,-0.049,-0.052,-0.097,-0.098,0.010,-0.019,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.049,-0.030,-0.025,-0.052,0.010,0.023,-0.007,-0.019]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.030,0.005,-0.049,-0.025,0.023,0.064,0.046,-0.007]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.005,1.000,1.000,-0.049,0.064,1.000,1.000,0.046]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.076,0.033,-0.025,-0.092,-0.018,0.032,-0.016,-0.033]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=223, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=207, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=141, num_verts=12
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=8, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=221, num_verts=6
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6033
  Total vertices to generate: 39627
  Last vert scan: 39627, orig: 0
  Last occupied scan: 6033, orig: 0
[MC DEBUG] Generating triangles for 6033 active voxels with 39627 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 972, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-slBICOmzkN3F1yh7-jrBwg
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 38
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x74f358084000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11435ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599888
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117408, weight=11.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 117409, weight=11.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117410, weight=11.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=4.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 117729, weight=5.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 117730, weight=2.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109648, weight=9.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 109649, weight=9.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 116927, weight=3.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=9.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 116927): coords=[47,61,14]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 117408): coords=[48,67,14]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117409): coords=[49,67,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117410): coords=[50,67,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.024,-0.023,-0.097,-0.098,0.007,0.009,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.100,-0.075,-0.085,-0.099,-0.099,-0.002,-0.065,-0.099]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.024,-0.017,-0.010,-0.023,0.007,0.012,0.031,0.009]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.017,0.014,0.044,-0.010,0.012,0.053,0.057,0.031]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [0.014,1.000,1.000,0.044,0.053,1.000,1.000,0.057]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=159, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=15, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=9, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=0, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5993
  Total vertices to generate: 39186
  Last vert scan: 39186, orig: 0
  Last occupied scan: 5993, orig: 0
[MC DEBUG] Generating triangles for 5993 active voxels with 39186 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 1037, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-qzZzUHFzJLAXXeWfVJXBYA
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7de628126000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11629ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599885
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101408, weight=8.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 101409, weight=7.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 108207, weight=8.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 108208, weight=6.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 108209, weight=12.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 108210, weight=9.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 124047, weight=8.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 124048, weight=13.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 124049, weight=16.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 124050, weight=11.000, pos=3
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 124047): coords=[47,50,15]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 124048): coords=[48,50,15]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 124049): coords=[49,50,15]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 124050): coords=[50,50,15]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 108207): coords=[47,52,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.008,0.012,-0.097,-0.099,-0.050,-0.036,-0.099]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.008,-0.021,-0.029,0.012,-0.050,-0.001,-0.030,-0.036]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.021,0.061,0.009,-0.029,-0.001,0.036,-0.010,-0.030]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.061,1.000,1.000,0.009,0.036,1.000,1.000,-0.010]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.094,-0.082,-0.087,-0.096,-0.095,-0.086,-0.066,-0.094]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=251, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=247, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=217, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=128, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5941
  Total vertices to generate: 38679
  Last vert scan: 38676, orig: 3
  Last occupied scan: 5940, orig: 1
[MC DEBUG] Generating triangles for 5941 active voxels with 38679 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 1108, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-WMesxm1bBHcX_VlHmVQNKQ
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7dd0fc023000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11449ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599886
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=9.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=8.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=5.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=5.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117729, weight=7.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117730, weight=2.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 108528, weight=10.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117247, weight=4.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 108287, weight=5.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=4.000, pos=0
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 117247): coords=[47,65,14]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 108287): coords=[47,53,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117728): coords=[48,71,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117729): coords=[49,71,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.033,-0.042,-0.097,-0.099,-0.028,-0.025,-0.098]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.099,-0.019,-0.089,-0.099,-0.099,-0.001,0.003,-0.099]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.096,-0.076,-0.091,-0.097,-0.094,-0.062,-0.091,-0.095]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.058,0.010,1.000,1.000,-0.023,-0.001,-0.002,-0.099]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [0.010,0.099,1.000,1.000,-0.001,-0.002,1.000,-0.002]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=191, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=255, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=241, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=176, num_verts=9
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5906
  Total vertices to generate: 38340
  Last vert scan: 38340, orig: 0
  Last occupied scan: 5906, orig: 0
[MC DEBUG] Generating triangles for 5906 active voxels with 38340 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 1175, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-ulwykOAWwaY7p2ESomacmw
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7881504e5000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11390ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599890
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 101568, weight=4.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 101569, weight=6.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 101570, weight=3.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=8.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=8.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=6.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 117487, weight=9.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 117488, weight=7.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 117489, weight=8.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 117490, weight=5.000, pos=3
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117487): coords=[47,68,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 117488): coords=[48,68,14]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 117489): coords=[49,68,14]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117490): coords=[50,68,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.098,-0.017,0.017,-0.098,-0.098,-0.009,-0.026,-0.097]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.017,-0.004,0.023,0.017,-0.009,-0.012,-0.013,-0.026]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.004,0.044,0.059,0.023,-0.012,0.043,0.011,-0.013]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.044,1.000,1.000,0.059,0.043,1.000,1.000,0.011]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.096,0.006,-0.019,-0.074,0.017,0.023,0.026,-0.055]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=251, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=243, num_verts=6
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=145, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=141, num_verts=12
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6014
  Total vertices to generate: 38895
  Last vert scan: 38895, orig: 0
  Last occupied scan: 6014, orig: 0
[MC DEBUG] Generating triangles for 6014 active voxels with 38895 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 1243, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-Tr9QKnDzaYVN3kuGzVLL-g
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7e8a5c046000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11475ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599883
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117728, weight=3.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 109568, weight=9.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 109569, weight=8.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 109570, weight=7.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 108528, weight=11.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 108529, weight=10.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 108530, weight=9.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 116767, weight=4.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 117407, weight=5.000, pos=3
[FIND ACTIVE DEBUG] Found active voxel at idx 117247, weight=5.000, pos=8
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 109568): coords=[48,69,13]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 109569): coords=[49,69,13]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 109570): coords=[50,69,13]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117407): coords=[47,67,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 108528): coords=[48,56,13]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.083,-0.041,0.000,-0.063,0.008,0.019,0.019,0.008]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.041,0.018,0.017,0.000,0.019,0.029,0.021,0.019]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [0.018,1.000,1.000,0.017,0.029,1.000,1.000,0.021]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [-0.098,-0.051,-0.016,-0.097,-0.098,-0.004,0.015,-0.098]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [-0.093,-0.085,-0.074,-0.092,-0.089,-0.010,-0.055,-0.086]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=11, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=1, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=0, num_verts=0
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=191, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=255, num_verts=0
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 5982
  Total vertices to generate: 39021
  Last vert scan: 39021, orig: 0
  Last occupied scan: 5982, orig: 0
[MC DEBUG] Generating triangles for 5982 active voxels with 39021 vertices

==========
== CUDA ==
==========

CUDA Version 12.1.1

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

Mesh Service starting...

========== MESH SERVICE CONFIGURATION ==========

[Memory Configuration]
  MESH_MAX_GPU_MEMORY = 4294967296 (4096 MB)
  MESH_MEMORY_BLOCK_SIZE = 67108864 (64 MB)
  MESH_MEMORY_POOL_SIZE = 1073741824 (1024 MB)

[Algorithm Parameters]
  MESH_TIME_DELTA_THRESHOLD = 0.001
  MESH_VELOCITY_SMOOTH_FACTOR = 0.800
  MESH_CAMERA_VELOCITY_THRESHOLD = 0.100
  MESH_OVERLAP_THRESHOLD = 0.900
  MESH_OCTREE_SCENE_SIZE = 10.000
  MESH_VELOCITY_CURRENT_FACTOR = 0.200
  MESH_MAX_SCENE_COORDINATE = 1000.000
  MESH_VOXEL_SIZE = 0.050
  MESH_INFLUENCE_RADIUS = 0.100
  MESH_CONFIDENCE_THRESHOLD = 0.100
  MESH_MAX_TSDF_WEIGHT = 100.000
  MESH_SIMPLIFICATION_RATIO = 0.100
  MESH_TRUNCATION_DISTANCE = 0.150
  MESH_OCTREE_LEAF_SIZE = 64
  MESH_OCTREE_MAX_DEPTH = 8
  MESH_MAX_VERTICES = 5000000
  MESH_NORMAL_K_NEIGHBORS = 30

[Debug Configuration]
  MESH_DEBUG_PRINT_LIMIT = 5
  MESH_DEBUG_SAVE_INTERVAL = 10
  MESH_FPS_LOG_INTERVAL = 30
  MESH_DEBUG_OUTPUT_DIR = /debug_output

===============================================

[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MIN: [-2.000, -3.000, 0.000]
[VOLUME BOUNDS FIX] Using environment TSDF_VOLUME_MAX: [2.000, 2.000, 10.000]
Initializing NVIDIA Marching Cubes with:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
  Volume dimensions: 4.000 x 5.000 x 10.000 meters
  Voxel grid: 80 x 100 x 200 = 1600000 voxels
  Estimated TSDF memory: 12 MB
[NVIDIA MC INIT] Initializing with bounds:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Truncation distance: 0.100m
[SIMPLE TSDF INIT] Initializing TSDF volume:
  Volume min: [-2.000, -3.000, 0.000]
  Volume max: [2.000, 2.000, 10.000]
  Voxel size: 0.050m
  Volume dimensions: [80, 100, 200]
  Total voxels: 1600000
SimpleTSDF initialized:
  Volume dims: 80x100x200
  Voxel size: 0.050m
  Memory usage: 12.207 MB
[NVIDIA MC INIT] NvidiaMarchingCubes initialized successfully
GPUMeshGenerator initialized with algorithm selector
Mesh method set to: 2
Mesh service configured with new algorithm selector:
  - NVIDIA Marching Cubes with optimized TSDF
  - Velocity-based algorithm switching (future-ready)
  - GPU Octree for spatial indexing
  - Memory pool allocation (1GB)
  - 90% spatial overlap deduplication
  - Environment-based configuration

TSDF Environment Configuration:
  TSDF_VOXEL_SIZE: 0.05m
  TSDF_TRUNCATION_DISTANCE: 0.10m
  TSDF_MAX_WEIGHT: 100.0
  TSDF_VOLUME_MIN: -2,-3,0
  TSDF_VOLUME_MAX: 2,2,10
Connected to Rerun viewer at 127.0.0.1:9876
Sent test grid points to Rerun viewer
Connected to Rerun viewer at 127.0.0.1:9876
Metrics server started on port 9091
Connecting to RabbitMQ at amqp://127.0.0.1:5672...
Metrics server listening on port 9091
RabbitMQ channel ready
Queue mesh_service_keyframes declared successfully. Messages: 1312, Consumers: 0
Queue bound to exchange slam3r_keyframe_exchange with routing key '#'
Started consuming with tag: amq.ctag-sEnXUppL8SWm_ZApXxEIsA
Received message, size: 318 bytes
Message type: 8
Iterating through msgpack map:
  Key: type, Value type: 5
  Key: keyframe_id, Value type: 5
  Key: timestamp_ns, Value type: 2
  Key: pose_matrix, Value type: 7
  Key: shm_key, Value type: 5
  Key: point_count, Value type: 2
  Key: bbox, Value type: 7
[DEBUG] Message has 'type' field: keyframe.new
Parsed message - shm_key: /slam3r_keyframe_1, keyframe_id: 1, type: keyframe.new, point_count: 32334
[MESSAGE TYPE FIX] Processing message with type: keyframe.new

Received keyframe 1 via RabbitMQ, shm_key: /slam3r_keyframe_1
[DEBUG] Opening shared memory segment: /slam3r_keyframe_1
[SHM DEBUG] Opening shared memory: /slam3r_keyframe_1
[SHM DEBUG] shm_open succeeded, fd: 39
[SHM DEBUG] Mapping header, size: 104
[SHM DEBUG] SharedKeyframe struct layout:
  offset of timestamp_ns: 0
  offset of point_count: 8
  offset of color_channels: 12
  offset of pose_matrix: 16
  offset of bbox: 80
[SHM DEBUG] Header mapped, point_count: 32334, color_channels: 3
[SHM DEBUG] Header timestamp: 1000000000
[SHM DEBUG] Header bbox: [-0.703, -1.165, 0.681] to [0.478, 0.984, 2.706]
[SHM DEBUG] Calculated total size: 485114
[SHM DEBUG] Remapping with full size
[SHM DEBUG] Full mapping successful at 0x7a146c0c9000
[DEBUG] Successfully opened shared memory
Processing keyframe with 32334 points
[DEBUG] Creating MeshUpdate object
[DEBUG] Calling generateIncrementalMesh
[DEBUG] Processing keyframe: spatial_hash=11093822414574, velocity=0.000 m/s, points=32334
[MESH GEN DEBUG] Checking point cloud bounds for 32334 points
[MESH GEN DEBUG] First 5 points raw values:
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
[MESH GEN DEBUG] Actual point cloud bounds:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
[MESH GEN DEBUG] Stored bbox in keyframe:
  Min: [-0.703, -1.165, 0.681]
  Max: [0.478, 0.984, 2.706]
Successfully connected to RabbitMQ
Mesh Service running. Waiting for keyframes from SLAM3R...
Normal estimation completed in 11674ms
[ALGORITHM SELECTOR] Selected method: 0 (0=PoissonRecon, 1=MarchingCubes)
[ALGORITHM SELECTOR] Camera velocity: 0.000 m/s
[ALGORITHM SELECTOR] Points: 32334, Complexity: 0.323
[ALGORITHM SELECTOR] Starting reconstruction...
[MC DEBUG] reconstruct() called with 32334 points
[MC DEBUG] Integrating points into TSDF...
[TSDF DEBUG] Camera position: [0.000, 0.000, 0.000]
[TSDF DEBUG] integrate() called with 32334 points
[TSDF DEBUG] First few points (world space):
  Point 0: [-0.691, -0.692, 1.029]
  Point 1: [-0.691, -0.699, 1.037]
  Point 2: [-0.690, -0.705, 1.044]
  Point 3: [-0.690, -0.712, 1.052]
  Point 4: [-0.690, -0.719, 1.062]
  Point 5: [-0.691, -0.725, 1.072]
  Point 6: [-0.692, -0.733, 1.082]
  Point 7: [-0.692, -0.742, 1.094]
  Point 8: [-0.693, -0.750, 1.105]
  Point 9: [-0.693, -0.758, 1.113]
[TSDF DEBUG] World-to-volume transform (column-major):
  Scale X: 20.000, Translation X: 40.000
  Scale Y: 20.000, Translation Y: 60.000
  Scale Z: 20.000, Translation Z: -0.000
[TSDF DEBUG] TSDF volume params:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
  Truncation distance: 0.100
[TSDF KERNEL] Point 0: world=[-0.691,-0.692,1.029] -> voxel=[26.182,46.156,20.575], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 1: world=[-0.691,-0.699,1.037] -> voxel=[26.188,46.021,20.734], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 2: world=[-0.690,-0.705,1.044] -> voxel=[26.201,45.894,20.878], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 3: world=[-0.690,-0.712,1.052] -> voxel=[26.194,45.760,21.040], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 4: world=[-0.690,-0.719,1.062] -> voxel=[26.190,45.620,21.236], normal=[1.000,0.000,0.000]
[TSDF KERNEL] Point 0 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 1 voxel bounds: min=[24,44,18], max=[29,49,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 2 voxel bounds: min=[24,43,18], max=[29,48,23], volume_dims=[80,100,200]
[TSDF KERNEL] Point 3 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[TSDF KERNEL] Point 4 voxel bounds: min=[24,43,19], max=[29,48,24], volume_dims=[80,100,200]
[MC DEBUG] TSDF integration complete
[MC DEBUG] TSDF volume stats:
  Total voxels: 1600000
  Modified voxels: 1599885
  Weighted voxels: 11429
[MC DEBUG] TSDF volume info:
  Dims: 80x100x200
  Origin: [-2.000, -3.000, 0.000]
  Voxel size: 0.050
[MC DEBUG FIX] Initialized d_active_count to 0
[MC DEBUG FIX] Allocated buffer for 22858 active voxels (safety margin from 11429 weighted)
[MC DEBUG] Finding active voxels from 11429 weighted voxels...
[FIND ACTIVE DEBUG] Found active voxel at idx 117568, weight=15.000, pos=4
[FIND ACTIVE DEBUG] Found active voxel at idx 117569, weight=11.000, pos=5
[FIND ACTIVE DEBUG] Found active voxel at idx 117570, weight=11.000, pos=6
[FIND ACTIVE DEBUG] Found active voxel at idx 116847, weight=2.000, pos=7
[FIND ACTIVE DEBUG] Found active voxel at idx 116848, weight=9.000, pos=8
[FIND ACTIVE DEBUG] Found active voxel at idx 116849, weight=11.000, pos=9
[FIND ACTIVE DEBUG] Found active voxel at idx 117487, weight=6.000, pos=0
[FIND ACTIVE DEBUG] Found active voxel at idx 117488, weight=9.000, pos=1
[FIND ACTIVE DEBUG] Found active voxel at idx 117489, weight=9.000, pos=2
[FIND ACTIVE DEBUG] Found active voxel at idx 117490, weight=10.000, pos=3
[MC DEBUG] Found 11429 active voxels to process
[MC DEBUG] First few weight values: 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 0.000 
[MC DEBUG] Classifying 11429 active voxels...
[MC CLASSIFY ACTIVE] Active voxel 0 (global idx 117487): coords=[47,68,14]
[MC CLASSIFY ACTIVE] Active voxel 1 (global idx 117488): coords=[48,68,14]
[MC CLASSIFY ACTIVE] Active voxel 2 (global idx 117489): coords=[49,68,14]
[MC CLASSIFY ACTIVE] Active voxel 3 (global idx 117490): coords=[50,68,14]
[MC CLASSIFY ACTIVE] Active voxel 4 (global idx 117568): coords=[48,69,14]
[MC CLASSIFY ACTIVE] Voxel 0 TSDF values: [-0.097,-0.027,0.015,-0.096,-0.098,-0.037,-0.022,-0.097]
[MC CLASSIFY ACTIVE] Voxel 1 TSDF values: [-0.027,-0.013,0.017,0.015,-0.037,0.006,-0.005,-0.022]
[MC CLASSIFY ACTIVE] Voxel 2 TSDF values: [-0.013,0.001,0.042,0.017,0.006,0.055,-0.007,-0.005]
[MC CLASSIFY ACTIVE] Voxel 3 TSDF values: [0.001,1.000,1.000,0.042,0.055,1.000,1.000,-0.007]
[MC CLASSIFY ACTIVE] Voxel 4 TSDF values: [0.015,0.017,0.026,-0.007,-0.022,-0.005,-0.021,0.012]
[MC CLASSIFY ACTIVE] Voxel 0: cube_index=251, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 1: cube_index=211, num_verts=15
[MC CLASSIFY ACTIVE] Voxel 2: cube_index=193, num_verts=9
[MC CLASSIFY ACTIVE] Voxel 3: cube_index=128, num_verts=3
[MC CLASSIFY ACTIVE] Voxel 4: cube_index=120, num_verts=12
[MC DEBUG] Active voxel classification complete
[MC DEBUG] Scan results:
  Active voxels processed: 11429
  Active voxels with triangles: 6054
  Total vertices to generate: 39225
  Last vert scan: 39225, orig: 0
  Last occupied scan: 6054, orig: 0
[MC DEBUG] Generating triangles for 6054 active voxels with 39225 vertices

==========
== CUDA ==
==========
